this the first commit, I hope the conflicts are easy to solve.
